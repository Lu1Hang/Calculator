# Calculator
18年的java课设：模拟科学计算器
课设报告部分内容：


各个类的作用

1）MainClass类：新建窗口，并设置大小和位置

2）Calculator类：设置计算器界面，并为按钮注册监视器。
firstDigit 判断是否是表达式的第一位
operatorFlag 判断是否出现运算符（前一位）
operatorFlag2 判断是否出现函数运算符（前一位）
pointFlag 判断是否出现小数点
pointFlag 判断小数点后是否有数字
numberFlag 判断是否出现数字（前一位）
hanshuFlag 判断当前界面是四则运算界面还是函数运算界面

①按下清零按钮时，输入端文本框清空输出端文本框清零，所有布尔类判断值重置。

②按下退格按钮时，设置整型del为1 ，表示删除的字符长度。表达式长度大于1时，判断最后一个字符，如果是运算符，普通运算符判断值变成false，函数运算符变成true；如果是三角函数运算符，普通运算符判断值变成false，函数运算符变成true，del的值变成3；如果是小数点，小数点判断值变成false，数字判断值变成true；如果是左括号运算符，左括号标记值减一；如果是右括号运算符，右括号标记值减一；如果是数字，再判断倒数第二个字符，若是小数点，小数点后数字判断值变成false，若是运算符，数字判断值变成false，普通运算符判断值变成true。删除长度为del的末尾字符。

③按下数字或小数点按钮时，判断是否为数字，再判断数字前是否有小数点运算符出现，若出现小数点运算符，则pointFlag变成true；若不是数字则是小数点符号，判断小数点是否出现过，若没有，则输出小数点。数字判断值变成false，普通运算判断值变成false，函数运算符判断值变成false。

④按下运算符按钮，首先判断当前界面是否是四则运算界面：若是，则判断普通运算符判断值为fals且小数点判断值与小数点后数字判断值相等，若成立，如果是等号按钮且左括号计数值与右括号计数值相等，调用getEventuate方法得到表达式的值，去掉该值末尾的无用小数后输出；不是等号的情况时，输入四则运算符。数值判断值变成false，普通运算符变成true，函数运算符变成false，小数点判断值变成false，小数点后数字判断值变成false。若当前界面不是四则运算界面，判断字符串长度是否大于3，大于3时，判断前三个字符是sin则输出sin值，若是cos，则输出cos，若是数字则判断最后一个字符是否为！，再判断符号前的数字是否为整数且不大于10000，符合要求便计算该数的阶乘并输出，否则弹出小窗报错；当字符串长度小于等于3时，判断最后一个字符是！，再判断符号前的数字是否是整数且小于10000，符合要求便计算该数的阶乘并输出，否则便弹出小窗报错。

⑤按下转换界面按钮（change按钮）时，判断当前界面是四则运算界面还是函数运算界面 ，改变相应按钮的颜色并将hanshuFlag取反。

⑥按下括号按钮，判断当前界面是四则运算界面，是的话，再判断是否为左括号，若是左括号，则左括号标记值加一；否则，右括号标记值加一。

⑦按下函数运算符按钮，判断当前界面是函数计算器界面，函数运算符判断值为false时，判断按钮是否为n！且数字判断值为true，若是，则输入阶乘符号；若不是，再判断按钮不是n！且数字判断值为false，符合条件则输入三角函数符号。函数运算符判断值变成true。

3）MyMath类： 
先将传入的字符串expression进行Recount方法处理，去掉不必要的空格并对存在错误的表达式进行纠错（如表达式末尾缺少右括号，则补上右括号；括号与数字之间缺少运算符，补上乘号）。对处理好的字符串进行AddStack方法运算，赋给index 的初值为0，判断第index个字符是否为数字或是小数点，若是，再次判断是否是小数点，若是小数点，小数点判断值变成true，否则将前几位的数值temp乘10再加上该字符的数值，数字判断值变成true，如果小数点判断值为true，记录小数为数的decimal乘10。index的值加一，再次判断第index个字符是否为数字或是小数点。第index个字符若不是小数点或是数字，则将数字字符结束值变成true，若数字判断值为true，对左括号前的负号进行特殊处理，若小数点判断值为true，temp=temp/decimal，得到真正的带有小数的正确值temp，并将temp压入doubStack栈中，若数字结束符号为true，得到表达式中下一个运算符nowaday和charStack栈中栈顶元素nextPop，用Judge方法比较两者的优先级，判断返回字符型优先级，若是’>’，表示nextPop运算符的优先级高，先计算该符号的运算，将计算结果result数值推入doubStack栈中；若是’<’，表示nextPop运算符的优先级低，将nextPop放回栈中，继续将nowaday运算符入栈；若是’=’，得到doubStack的栈顶元素的值，返回该值的字符串类型，并保留四位小数；若是’K’，表示左括号与右括号相撞，出栈的左括号不入栈，并从左括号开始把符号往下移一位，index的值加一,退出当前循环；若是’E’，返回ERROR字符串。在外部循环中index的值加一。
